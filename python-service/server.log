INFO:     Will watch for changes in these directories: ['/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [28871] using WatchFiles
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [28885]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
[ModelPipeline] Initializing on device: cpu
INFO:     127.0.0.1:59707 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:59770 - "GET / HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 80.2, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 80.2 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
[Inference] Processing 2 thumbnails for: 'Amazing Tech Tutorial - How To Fix Your PC'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 800ms. Winner: thumb1 (84.0%)
INFO:     127.0.0.1:59772 - "POST /v1/score HTTP/1.1" 200 OK
INFO:     127.0.0.1:60200 - "GET / HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
[Inference] Processing 2 thumbnails for: 'Amazing Tech Tutorial - How To Fix Your PC'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 181ms. Winner: thumb1 (84.0%)
INFO:     127.0.0.1:60202 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_base64.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [28885]
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
WARNING:  WatchFiles detected changes in 'minimal_server.py'. Reloading...
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [29225]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'create_test_image.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [29225]
[ModelPipeline] Initializing on device: cpu
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [29240]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
[ModelPipeline] Initializing on device: cpu
INFO:     127.0.0.1:60430 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:60437 - "GET / HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 3670379100
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
[Inference] Processing 2 thumbnails for: 'Amazing Tech Tutorial - How To Fix Your PC'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 193ms. Winner: thumb1 (84.0%)
INFO:     127.0.0.1:60439 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py', 'test_e2e.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [29240]
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [29326]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 105194767
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 105194767
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2972829540
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2972829540
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 869851645
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 869851645
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
[ModelPipeline] Initializing on device: cpu
[Inference] Processing 3 thumbnails for: 'Sample Video Title'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Processing 3 thumbnails for: 'Sample Video Title'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb3 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb3 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 3201ms. Winner: thumb1 (84.0%)
INFO:     127.0.0.1:60627 - "POST /v1/score HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 2836ms. Winner: thumb1 (84.0%)
INFO:     127.0.0.1:60628 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:app.main:[CLIP] Generated deterministic embedding with seed 1376104312
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 1376104312
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 146430332
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[SCORING] Raw score: 79.4, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 79.4 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 146430332
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[SCORING] Raw score: 78.7, Amplified score: 83
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 78.7 → Final: 83
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 4132281272
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:app.main:[SCORING] Raw score: 78.7, Amplified score: 83
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 78.7 → Final: 83
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
WARNING:app.main:[face_debug] Face or emotion model is None - using intelligent fallback face detection
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
INFO:app.main:[CLIP] Generated deterministic embedding with seed 4132281272
INFO:app.main:[POWER_WORDS] Niche 'tech': 50.0/100 - ❌ Generic text won't drive clicks. Try: INSANE [Topic] REVEALED - You Won't Believe This!
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 80.2, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 80.2 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
[Inference] Processing 3 thumbnails for: 'Sample Video Title'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Processing 3 thumbnails for: 'Sample Video Title'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb3 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb3 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 4969ms. Winner: thumb3 (84.0%)
INFO:     127.0.0.1:60820 - "POST /v1/score HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 80.2, Amplified score: 84
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 80.2 → Final: 84
INFO:app.main:[SUBS] Sim: 75→82, Power: 50→69, Clarity: 95→92
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 4534ms. Winner: thumb3 (84.0%)
INFO:     127.0.0.1:60822 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.tasks.build_faiss_index:FAISS index path: faiss_indices
INFO:     127.0.0.1:62532 - "GET /internal/faiss-status HTTP/1.1" 200 OK
INFO:app.main:Manual thumbnail library refresh requested
INFO:app.main:[Thumbscore] Updating reference thumbnail library...
INFO:app.tasks.collect_thumbnails:[Thumbscore] Updating reference thumbnail library...
INFO:app.tasks.collect_thumbnails:Target: 200 videos per niche (7 niches)
INFO:app.tasks.collect_thumbnails:Processing niche: tech (category 28)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for tech
ERROR:app.tasks.collect_thumbnails:API request failed for tech: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=28&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for tech
WARNING:app.tasks.collect_thumbnails:No videos fetched for tech
INFO:app.tasks.collect_thumbnails:Processing niche: gaming (category 20)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for gaming
ERROR:app.tasks.collect_thumbnails:API request failed for gaming: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=20&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for gaming
WARNING:app.tasks.collect_thumbnails:No videos fetched for gaming
INFO:app.tasks.collect_thumbnails:Processing niche: education (category 27)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for education
ERROR:app.tasks.collect_thumbnails:API request failed for education: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=27&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for education
WARNING:app.tasks.collect_thumbnails:No videos fetched for education
INFO:app.tasks.collect_thumbnails:Processing niche: entertainment (category 24)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for entertainment
ERROR:app.tasks.collect_thumbnails:API request failed for entertainment: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=24&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for entertainment
WARNING:app.tasks.collect_thumbnails:No videos fetched for entertainment
INFO:app.tasks.collect_thumbnails:Processing niche: people (category 22)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for people
ERROR:app.tasks.collect_thumbnails:API request failed for people: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=22&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for people
WARNING:app.tasks.collect_thumbnails:No videos fetched for people
INFO:app.tasks.collect_thumbnails:Processing niche: travel (category 19)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for travel
ERROR:app.tasks.collect_thumbnails:API request failed for travel: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=19&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for travel
WARNING:app.tasks.collect_thumbnails:No videos fetched for travel
INFO:app.tasks.collect_thumbnails:Processing niche: general (category 10)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for general
ERROR:app.tasks.collect_thumbnails:API request failed for general: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=10&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for general
WARNING:app.tasks.collect_thumbnails:No videos fetched for general
INFO:httpx:HTTP Request: DELETE https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?collected_at=lt.2025-07-17T05%3A28%3A59.758184 "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.collect_thumbnails:Failed to cleanup old thumbnails: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.tasks.collect_thumbnails:📊 COLLECTION SUMMARY
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.tasks.collect_thumbnails:  tech        :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  gaming      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  education   :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  entertainment:   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  people      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  travel      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  general     :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:------------------------------------------------------------
INFO:app.tasks.collect_thumbnails:  TOTAL       :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  Processing  : 3.2s (0.0 thumbnails/sec)
INFO:app.tasks.collect_thumbnails:  Cleanup     : 0 old thumbnails removed
INFO:app.tasks.collect_thumbnails:  Status      : ❌ FAILED
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.main:Library refresh completed: {'total_videos_fetched': 0, 'total_thumbnails_stored': 0, 'niches_processed': 7, 'old_thumbnails_deleted': 0, 'processing_time_seconds': 3.174422025680542, 'niche_stats': {'tech': {'fetched': 0, 'stored': 0}, 'gaming': {'fetched': 0, 'stored': 0}, 'education': {'fetched': 0, 'stored': 0}, 'entertainment': {'fetched': 0, 'stored': 0}, 'people': {'fetched': 0, 'stored': 0}, 'travel': {'fetched': 0, 'stored': 0}, 'general': {'fetched': 0, 'stored': 0}}, 'throughput_thumbnails_per_sec': 0.0}
INFO:app.main:Rebuilding FAISS indices...
INFO:app.tasks.build_faiss_index:Rebuilding FAISS indices...
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: tech
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.tech&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for tech - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: gaming
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.gaming&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for gaming: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for gaming - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: education
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.education&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for education: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for education - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: entertainment
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.entertainment&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for entertainment: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for entertainment - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: people
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.people&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for people: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for people - no embeddings
INFO:app.tasks.build_faiss_index:Done building FAISS indices in 0.40s: 0/5 successful
INFO:app.main:FAISS index building completed: {'tech': False, 'gaming': False, 'education': False, 'entertainment': False, 'people': False}
INFO:app.faiss_cache:[FAISS] Refreshing index cache...
INFO:app.faiss_cache:[FAISS] Loading indices from faiss_indices
INFO:app.faiss_cache:[FAISS] Loaded index for tech (171 items)
INFO:app.faiss_cache:[FAISS] Cache ready with 1 niches (171 total items)
INFO:app.faiss_cache:[FAISS] Memory usage: ~0.3 MB
INFO:app.main:Done building FAISS indices.
INFO:     127.0.0.1:62784 - "GET /internal/refresh-library HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/tasks/collect_thumbnails.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [29326]
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
WARNING:  WatchFiles detected changes in 'app/tasks/collect_thumbnails.py'. Reloading...
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [29983]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'youtube_brain/data_collector.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [29983]
[ModelPipeline] Initializing on device: cpu
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [30010]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'youtube_brain/niche_models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [30010]
[ModelPipeline] Initializing on device: cpu
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [30057]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'youtube_brain/data_collector.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [30057]
[ModelPipeline] Initializing on device: cpu
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [30103]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'youtube_brain/niche_models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [30103]
[ModelPipeline] Initializing on device: cpu
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [30199]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
INFO:app.main:Manual thumbnail library refresh requested
INFO:app.main:[Thumbscore] Updating reference thumbnail library...
INFO:app.tasks.collect_thumbnails:[Thumbscore] Updating reference thumbnail library...
INFO:app.tasks.collect_thumbnails:Target: 200 videos per niche (8 niches)
INFO:app.tasks.collect_thumbnails:Processing niche: tech (category 28)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for tech
ERROR:app.tasks.collect_thumbnails:API request failed for tech: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=28&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for tech
WARNING:app.tasks.collect_thumbnails:No videos fetched for tech
INFO:app.tasks.collect_thumbnails:Processing niche: gaming (category 20)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for gaming
ERROR:app.tasks.collect_thumbnails:API request failed for gaming: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=20&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for gaming
WARNING:app.tasks.collect_thumbnails:No videos fetched for gaming
INFO:app.tasks.collect_thumbnails:Processing niche: education (category 27)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for education
ERROR:app.tasks.collect_thumbnails:API request failed for education: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=27&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for education
WARNING:app.tasks.collect_thumbnails:No videos fetched for education
INFO:app.tasks.collect_thumbnails:Processing niche: entertainment (category 24)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for entertainment
ERROR:app.tasks.collect_thumbnails:API request failed for entertainment: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=24&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for entertainment
WARNING:app.tasks.collect_thumbnails:No videos fetched for entertainment
INFO:app.tasks.collect_thumbnails:Processing niche: people (category 22)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for people
ERROR:app.tasks.collect_thumbnails:API request failed for people: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=22&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for people
WARNING:app.tasks.collect_thumbnails:No videos fetched for people
INFO:app.tasks.collect_thumbnails:Processing niche: business (category 25)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for business
ERROR:app.tasks.collect_thumbnails:API request failed for business: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=25&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for business
WARNING:app.tasks.collect_thumbnails:No videos fetched for business
INFO:app.tasks.collect_thumbnails:Processing niche: travel (category 19)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for travel
ERROR:app.tasks.collect_thumbnails:API request failed for travel: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=19&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for travel
WARNING:app.tasks.collect_thumbnails:No videos fetched for travel
INFO:app.tasks.collect_thumbnails:Processing niche: general (category 10)
INFO:app.tasks.collect_thumbnails:Fetching up to 200 trending videos for general
ERROR:app.tasks.collect_thumbnails:API request failed for general: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/videos?part=snippet%2Cstatistics%2CcontentDetails&chart=mostPopular&regionCode=US&videoCategoryId=10&maxResults=50&key=AIzaSyCL6s5QZWeLMTqAXxkviGAjSUy4iinRjng
INFO:app.tasks.collect_thumbnails:Fetched 0 trending videos for general
WARNING:app.tasks.collect_thumbnails:No videos fetched for general
INFO:httpx:HTTP Request: DELETE https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?collected_at=lt.2025-07-17T05%3A31%3A22.778082 "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.collect_thumbnails:Failed to cleanup old thumbnails: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.tasks.collect_thumbnails:📊 COLLECTION SUMMARY
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.tasks.collect_thumbnails:  tech        :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  gaming      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  education   :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  entertainment:   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  people      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  business    :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  travel      :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  general     :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:------------------------------------------------------------
INFO:app.tasks.collect_thumbnails:  TOTAL       :   0 fetched |   0 stored
INFO:app.tasks.collect_thumbnails:  Processing  : 2.8s (0.0 thumbnails/sec)
INFO:app.tasks.collect_thumbnails:  Cleanup     : 0 old thumbnails removed
INFO:app.tasks.collect_thumbnails:  Status      : ❌ FAILED
INFO:app.tasks.collect_thumbnails:============================================================
INFO:app.main:Library refresh completed: {'total_videos_fetched': 0, 'total_thumbnails_stored': 0, 'niches_processed': 8, 'old_thumbnails_deleted': 0, 'processing_time_seconds': 2.794595956802368, 'niche_stats': {'tech': {'fetched': 0, 'stored': 0}, 'gaming': {'fetched': 0, 'stored': 0}, 'education': {'fetched': 0, 'stored': 0}, 'entertainment': {'fetched': 0, 'stored': 0}, 'people': {'fetched': 0, 'stored': 0}, 'business': {'fetched': 0, 'stored': 0}, 'travel': {'fetched': 0, 'stored': 0}, 'general': {'fetched': 0, 'stored': 0}}, 'throughput_thumbnails_per_sec': 0.0}
INFO:app.main:Rebuilding FAISS indices...
INFO:app.tasks.build_faiss_index:FAISS index path: faiss_indices
INFO:app.tasks.build_faiss_index:Rebuilding FAISS indices...
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: tech
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.tech&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for tech - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: gaming
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.gaming&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for gaming: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for gaming - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: education
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.education&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for education: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for education - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: entertainment
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.entertainment&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for entertainment: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for entertainment - no embeddings
INFO:app.tasks.build_faiss_index:Fetching embeddings for niche: people
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/ref_thumbnails?select=video_id%2C%20embedding&niche=eq.people&order=views_per_hour.desc "HTTP/1.1 401 Unauthorized"
ERROR:app.tasks.build_faiss_index:Error fetching embeddings for people: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.tasks.build_faiss_index:Skipping FAISS index for people - no embeddings
INFO:app.tasks.build_faiss_index:Done building FAISS indices in 0.35s: 0/5 successful
INFO:app.main:FAISS index building completed: {'tech': False, 'gaming': False, 'education': False, 'entertainment': False, 'people': False}
INFO:app.faiss_cache:[FAISS] Refreshing index cache...
INFO:app.faiss_cache:[FAISS] Loading indices from faiss_indices
INFO:app.faiss_cache:[FAISS] Loaded index for tech (171 items)
INFO:app.faiss_cache:[FAISS] Cache ready with 1 niches (171 total items)
INFO:app.faiss_cache:[FAISS] Memory usage: ~0.3 MB
INFO:app.main:Done building FAISS indices.
[ModelPipeline] Initializing on device: cpu
INFO:     127.0.0.1:63466 - "GET /internal/refresh-library HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[POWER_WORDS] Niche 'business': 30.0/100 - ❌ Add bold text with 2-3 power words. Example: "SHOCKING Results REVEALED"
WARNING:app.faiss_cache:[FAISS] Index for business not found in cache
WARNING:app.ref_library:FAISS index for business not found in cache
WARNING:app.ref_library:FAISS index not available for business
INFO:app.ref_library:FAISS not available for business, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for business similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for business: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for business, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'business': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 68.5, Amplified score: 78
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'business' - Raw: 68.5 → Final: 78
INFO:app.main:[SUBS] Sim: 75→82, Power: 30→60, Clarity: 85→88
INFO:app.main:[DETERMINISTIC] Cached score for niche 'business'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'business' - returning cached score
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 246ms. Winner: thumb1 (78.0%)
INFO:     127.0.0.1:63624 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
INFO:apscheduler.scheduler:Scheduler has been shut down
INFO:     Application shutdown complete.
INFO:     Finished server process [30199]
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:app.determinism:[DETERMINISTIC] Initializing deterministic mode
INFO:app.determinism:[DETERMINISTIC] Setting seeds to 42
INFO:app.determinism:[DETERMINISTIC] PyTorch seeds set
INFO:app.determinism:[DETERMINISTIC] Cache initialized at deterministic_cache
INFO:app.determinism:[DETERMINISTIC] Global normalizer initialized
INFO:app.main:[DETERMINISTIC] Mode: ENABLED
INFO:app.main:[DETERMINISTIC] Score version: v1.4-faiss-hybrid
INFO:app.main:[DETERMINISTIC] Model version: clip-vit-l14-v1.4-faiss-hybrid
INFO:     Started server process [30502]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[STARTUP] Temporarily skipping model initialization for faster startup...
INFO:app.main:[STARTUP] Models will be lazy-loaded on first request
INFO:app.main:[STARTUP] Temporarily skipping Brain initialization...
INFO:app.main:[STARTUP] Temporarily skipping FAISS initialization...
INFO:app.main:[FAISS] ⚠️ FAISS temporarily disabled for debugging
INFO:app.main:======================================================================
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "Collect thumbnails and rebuild FAISS indices" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:app.main:Scheduler started:
INFO:app.main:  - Library refresh + FAISS index rebuilding: 3:00 AM Hobart time daily
INFO:     Application startup complete.
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'business' - returning cached score
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'business' - returning cached score
[ModelPipeline] Initializing on device: cpu
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 25ms. Winner: thumb1 (78.0%)
INFO:     127.0.0.1:63840 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'business' - returning cached score
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'business' - returning cached score
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'business'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 4ms. Winner: thumb1 (78.0%)
INFO:     127.0.0.1:63898 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[POWER_WORDS] Niche 'tech': 30.0/100 - ❌ Add bold text with 2-3 power words. Example: "SHOCKING Results REVEALED"
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for tech not found in cache
WARNING:app.ref_library:FAISS index for tech not found in cache
WARNING:app.ref_library:FAISS index not available for tech
INFO:app.ref_library:FAISS not available for tech, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for tech similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for tech: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for tech, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'tech': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 68.5, Amplified score: 78
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'tech' - Raw: 68.5 → Final: 78
INFO:app.main:[SUBS] Sim: 75→82, Power: 30→60, Clarity: 85→88
INFO:app.main:[DETERMINISTIC] Cached score for niche 'tech'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'tech' - returning cached score
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'tech'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 201ms. Winner: thumb1 (78.0%)
INFO:     127.0.0.1:63900 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[POWER_WORDS] Niche 'gaming': 30.0/100 - ❌ Add bold text with 2-3 power words. Example: "SHOCKING Results REVEALED"
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for gaming not found in cache
WARNING:app.ref_library:FAISS index for gaming not found in cache
WARNING:app.ref_library:FAISS index not available for gaming
INFO:app.ref_library:FAISS not available for gaming, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for gaming similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for gaming: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for gaming, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'gaming': 78.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 66.7, Amplified score: 77
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'gaming' - Raw: 66.7 → Final: 77
INFO:app.main:[SUBS] Sim: 78→83, Power: 30→60, Clarity: 85→88
INFO:app.main:[DETERMINISTIC] Cached score for niche 'gaming'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'gaming' - returning cached score
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'gaming'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'gaming'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 195ms. Winner: thumb1 (77.0%)
INFO:     127.0.0.1:63903 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[POWER_WORDS] Niche 'general': 30.0/100 - ❌ Add bold text with 2-3 power words. Example: "SHOCKING Results REVEALED"
WARNING:app.main:[FAISS] Cache is empty - no indices loaded
WARNING:app.faiss_cache:[FAISS] Index for general not found in cache
WARNING:app.ref_library:FAISS index for general not found in cache
WARNING:app.ref_library:FAISS index not available for general
INFO:app.ref_library:FAISS not available for general, using Supabase fallback
INFO:app.ref_library:Using Supabase fallback for general similarity
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/match_thumbnails "HTTP/1.1 401 Unauthorized"
ERROR:app.ref_library:Supabase fallback failed for general: {'message': 'Invalid API key', 'hint': 'Double check your Supabase `anon` or `service_role` API key.'}
WARNING:app.ref_library:All similarity methods failed for general, returning None for caller handling
WARNING:app.main:[SIMILARITY] Niche 'general': 75.0 (from baseline - FAISS unavailable) ⚠️
INFO:app.main:[MODEL_STATUS] OCR detection: fallback, Face detection: fallback
INFO:app.main:[SCORING] Raw score: 68.5, Amplified score: 78
INFO:app.main:[DEBUG] amplified_subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
INFO:app.main:[SCORE] Niche 'general' - Raw: 68.5 → Final: 78
INFO:app.main:[SUBS] Sim: 75→82, Power: 30→60, Clarity: 85→88
INFO:app.main:[DETERMINISTIC] Cached score for niche 'general'
INFO:app.main:[ocr_debug] OCR model available: False
WARNING:app.main:[ocr_debug] OCR model is None - using intelligent fallback text detection
INFO:app.main:[OCR_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[face_debug] Face model available: False
INFO:app.main:[face_debug] Emotion model available: False
INFO:app.main:[FACE_FALLBACK] Image too small ((1, 1)), using default values
INFO:app.main:[CLIP] Generated deterministic embedding with seed 2241320167
INFO:app.main:[DETERMINISTIC] Cache hit for niche 'general' - returning cached score
[Inference] Processing 2 thumbnails for: 'How to Make $100K Per Month'
[Inference] Analyzing thumbnail thumb1 for niche 'general'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Analyzing thumbnail thumb2 for niche 'general'...
[Inference] Features extracted successfully
[Inference] Prediction completed, subscores keys: ['similarity', 'power_words', 'brain_weighted', 'clarity', 'subject_prominence', 'contrast_pop', 'emotion', 'hierarchy', 'title_match']
[Inference] Completed in 175ms. Winner: thumb1 (78.0%)
INFO:     127.0.0.1:63913 - "POST /v1/score HTTP/1.1" 200 OK
