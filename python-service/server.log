INFO:     Will watch for changes in these directories: ['/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [71319] using WatchFiles

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [71322]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
[V1 ModelPipeline] Simplified mode - minimal model loading
INFO:     127.0.0.1:64181 - "GET / HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4
INFO:app.main:[CREDITS] Processing request for user: 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 11/100 (remaining: 89)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 6c2e26bc-3129-47f3-8b17-94b58cdfb4e4: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=640d66fb...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 164
INFO:scoring_v1_stable:[GPT-4] Raw response preview: I'm unable to analyze or provide feedback on images of people. If you have a different type of thumb...
ERROR:scoring_v1_stable:[GPT-4] JSON parse error: Expecting value: line 1 column 1 (char 0)
ERROR:scoring_v1_stable:[GPT-4] Content that failed to parse: I'm unable to analyze or provide feedback on images of people. If you have a different type of thumbnail or need help with something else, feel free to let me know!
ERROR:scoring_v1_stable:GPT-4 Vision rubric failed: Invalid JSON response: Expecting value: line 1 column 1 (char 0)
INFO:scoring_v1_stable:[NICHE] Slight penalty applied: 3/5 -> 61.2 -> 49.0 (20% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 3, 'text_readability': 3, 'color_contrast': 3, 'title_alignment': 3, 'niche_relevance': 3, 'notes': 'Fallback scoring due to API error'} -> rubric_score=49.0
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760588836.131454 13097265 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760588836.137707 13102068 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=91 contrast=23 subject=66 sat=40 -> core=55
INFO:scoring_v1_stable:[Blend] final=45.9 confidence=high
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 45.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 45.9/100
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 10238ms. Winner: thumb1
INFO:     127.0.0.1:65402 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 959d0178-df62-45ba-baca-1ed3929368ba
INFO:app.main:[CREDITS] Processing request for user: 959d0178-df62-45ba-baca-1ed3929368ba (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.959d0178-df62-45ba-baca-1ed3929368ba "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 959d0178-df62-45ba-baca-1ed3929368ba
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.959d0178-df62-45ba-baca-1ed3929368ba "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 959d0178-df62-45ba-baca-1ed3929368ba
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 12/100 (remaining: 88)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.959d0178-df62-45ba-baca-1ed3929368ba "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.959d0178-df62-45ba-baca-1ed3929368ba "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 959d0178-df62-45ba-baca-1ed3929368ba, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.959d0178-df62-45ba-baca-1ed3929368ba "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 959d0178-df62-45ba-baca-1ed3929368ba consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 959d0178-df62-45ba-baca-1ed3929368ba: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=640d66fb...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 45.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 45.9/100
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1418ms. Winner: thumb1
INFO:     127.0.0.1:49253 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [71322]

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [71678]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 735b2064-3194-4e5e-81a6-15959bcf820a
INFO:app.main:[CREDITS] Processing request for user: 735b2064-3194-4e5e-81a6-15959bcf820a (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.735b2064-3194-4e5e-81a6-15959bcf820a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 735b2064-3194-4e5e-81a6-15959bcf820a
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.735b2064-3194-4e5e-81a6-15959bcf820a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 735b2064-3194-4e5e-81a6-15959bcf820a
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 13/100 (remaining: 87)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.735b2064-3194-4e5e-81a6-15959bcf820a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.735b2064-3194-4e5e-81a6-15959bcf820a "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 735b2064-3194-4e5e-81a6-15959bcf820a, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.735b2064-3194-4e5e-81a6-15959bcf820a "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 735b2064-3194-4e5e-81a6-15959bcf820a consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 735b2064-3194-4e5e-81a6-15959bcf820a: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=640d66fb...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 357
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 3,
    "subject_prominence": 4,
    "emotion": 4,
    "text_readability": 0,
...
WARNING:scoring_v1_stable:[NICHE] Heavy penalty applied: 1/5 -> 50.4 -> 10.1 (80% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 4, 'emotion': 4, 'text_readability': 0, 'color_contrast': 3, 'title_alignment': 0, 'niche_relevance': 1, 'notes': "The image is visually appealing with a clear and prominent subject. Emotion is positive, but there's no text or clear business context, making niche relevance low."} -> rubric_score=10.1
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760588931.593015 13103531 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760588931.655018 13103904 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=91 contrast=23 subject=66 sat=40 -> core=55
INFO:scoring_v1_stable:[Blend] final=35.2 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 35.2/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 35.2/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[DEBUG] Thumbnail thumb1 data:
[DEBUG] Rubric keys: ['visual_appeal', 'subject_prominence', 'emotion', 'text_readability', 'color_contrast', 'title_alignment', 'niche_relevance', 'notes', 'rubric_score']
[DEBUG] Numeric core keys: ['text_clarity', 'color_contrast', 'subject_size', 'saturation_energy', 'core_score']
[DEBUG] Numeric core values: {'text_clarity': 91, 'color_contrast': 23, 'subject_size': 66, 'saturation_energy': 40, 'core_score': 55}
[V1] Completed in 13100ms. Winner: thumb1
INFO:     127.0.0.1:49398 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [71678]

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [71787]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 7b463b0a-dc2c-4e79-bf67-f741e3f222c4
INFO:app.main:[CREDITS] Processing request for user: 7b463b0a-dc2c-4e79-bf67-f741e3f222c4 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.7b463b0a-dc2c-4e79-bf67-f741e3f222c4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 7b463b0a-dc2c-4e79-bf67-f741e3f222c4
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.7b463b0a-dc2c-4e79-bf67-f741e3f222c4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 7b463b0a-dc2c-4e79-bf67-f741e3f222c4
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 14/100 (remaining: 86)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.7b463b0a-dc2c-4e79-bf67-f741e3f222c4 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.7b463b0a-dc2c-4e79-bf67-f741e3f222c4 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 7b463b0a-dc2c-4e79-bf67-f741e3f222c4, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.7b463b0a-dc2c-4e79-bf67-f741e3f222c4 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 7b463b0a-dc2c-4e79-bf67-f741e3f222c4 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 7b463b0a-dc2c-4e79-bf67-f741e3f222c4: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=640d66fb...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 453
INFO:scoring_v1_stable:[GPT-4] Raw response preview: I'm unable to analyze or provide feedback on this image as it doesn't contain any business-related e...
ERROR:scoring_v1_stable:[GPT-4] JSON parse error: Expecting value: line 1 column 1 (char 0)
ERROR:scoring_v1_stable:[GPT-4] Content that failed to parse: I'm unable to analyze or provide feedback on this image as it doesn't contain any business-related elements or text typically found in a YouTube thumbnail for business content. 

```json
{
    "visual_appeal": 2,
    "subject_prominence": 3,
    "emotion": 3,
    "text_readability": 0,
    "color_contrast": 2,
    "title_alignment": 0,
    "niche_relevance": 0,
    "notes": "The image is a portrait and lacks business-related elements or text."
}
```
ERROR:scoring_v1_stable:GPT-4 Vision rubric failed: Invalid JSON response: Expecting value: line 1 column 1 (char 0)
INFO:scoring_v1_stable:[NICHE] Slight penalty applied: 3/5 -> 61.2 -> 49.0 (20% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 3, 'text_readability': 3, 'color_contrast': 3, 'title_alignment': 3, 'niche_relevance': 3, 'notes': 'Fallback scoring due to API error'} -> rubric_score=49.0
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760589014.576349 13105039 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760589014.634675 13105547 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=91 contrast=23 subject=66 sat=40 -> core=55
INFO:scoring_v1_stable:[Blend] final=45.9 confidence=high
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 45.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 45.9/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[DEBUG] Thumbnail thumb1 data:
[DEBUG] Rubric keys: ['visual_appeal', 'subject_prominence', 'emotion', 'text_readability', 'color_contrast', 'title_alignment', 'niche_relevance', 'notes', 'rubric_score']
[DEBUG] Numeric core keys: ['text_clarity', 'color_contrast', 'subject_size', 'saturation_energy', 'core_score']
[DEBUG] Numeric core values: {'text_clarity': 91, 'color_contrast': 23, 'subject_size': 66, 'saturation_energy': 40, 'core_score': 55}
[DEBUG] SubScores values:
[DEBUG]   clarity: 91.0
[DEBUG]   subject_prominence: 66.0
[DEBUG]   contrast_pop: 23.0
[DEBUG]   emotion: 60.0
[DEBUG]   hierarchy: 60.0
[V1] Completed in 14415ms. Winner: thumb1
INFO:     127.0.0.1:49809 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 5adf39ac-75a1-4d4e-a959-e6cba272b473
INFO:app.main:[CREDITS] Processing request for user: 5adf39ac-75a1-4d4e-a959-e6cba272b473 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.5adf39ac-75a1-4d4e-a959-e6cba272b473 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 5adf39ac-75a1-4d4e-a959-e6cba272b473
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.5adf39ac-75a1-4d4e-a959-e6cba272b473 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 5adf39ac-75a1-4d4e-a959-e6cba272b473
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 15/100 (remaining: 85)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.5adf39ac-75a1-4d4e-a959-e6cba272b473 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.5adf39ac-75a1-4d4e-a959-e6cba272b473 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 5adf39ac-75a1-4d4e-a959-e6cba272b473, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.5adf39ac-75a1-4d4e-a959-e6cba272b473 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 5adf39ac-75a1-4d4e-a959-e6cba272b473 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 5adf39ac-75a1-4d4e-a959-e6cba272b473: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=640d66fb...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 45.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 45.9/100
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[DEBUG] Thumbnail thumb1 data:
[DEBUG] Rubric keys: ['visual_appeal', 'subject_prominence', 'emotion', 'text_readability', 'color_contrast', 'title_alignment', 'niche_relevance', 'notes', 'rubric_score']
[DEBUG] Numeric core keys: ['text_clarity', 'color_contrast', 'subject_size', 'saturation_energy', 'core_score']
[DEBUG] Numeric core values: {'text_clarity': 91, 'color_contrast': 23, 'subject_size': 66, 'saturation_energy': 40, 'core_score': 55}
[DEBUG] SubScores values:
[DEBUG]   clarity: 91.0
[DEBUG]   subject_prominence: 66.0
[DEBUG]   contrast_pop: 23.0
[DEBUG]   emotion: 60.0
[DEBUG]   hierarchy: 60.0
[V1] Completed in 1412ms. Winner: thumb1
INFO:     127.0.0.1:50008 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [71787]

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72087]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 97992947-5fe8-45eb-bba8-ab24c324064a
INFO:app.main:[CREDITS] Processing request for user: 97992947-5fe8-45eb-bba8-ab24c324064a (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.97992947-5fe8-45eb-bba8-ab24c324064a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 97992947-5fe8-45eb-bba8-ab24c324064a
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.97992947-5fe8-45eb-bba8-ab24c324064a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 97992947-5fe8-45eb-bba8-ab24c324064a
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 16/100 (remaining: 84)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.97992947-5fe8-45eb-bba8-ab24c324064a "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.97992947-5fe8-45eb-bba8-ab24c324064a "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 97992947-5fe8-45eb-bba8-ab24c324064a, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.97992947-5fe8-45eb-bba8-ab24c324064a "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 97992947-5fe8-45eb-bba8-ab24c324064a consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 97992947-5fe8-45eb-bba8-ab24c324064a: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=640d66fb...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 404
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 3,
    "subject_prominence": 4,
    "emotion": 4,
    "text_readability": 0,
...
WARNING:scoring_v1_stable:[NICHE] Heavy penalty applied: 0/5 -> 50.4 -> 10.1 (80% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 4, 'emotion': 4, 'text_readability': 0, 'color_contrast': 3, 'title_alignment': 0, 'niche_relevance': 0, 'notes': 'The thumbnail features a clear, well-lit portrait of a person, which is visually appealing and shows emotion. However, it lacks text and any business-related elements, making it irrelevant for a business niche.'} -> rubric_score=10.1
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760589150.640527 13107891 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760589150.697779 13108340 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=91 contrast=23 subject=66 sat=40 -> core=55
INFO:scoring_v1_stable:[Blend] final=35.2 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 35.2/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 35.2/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 12477ms. Winner: thumb1
INFO:     127.0.0.1:50404 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 47932d17-d8e7-4b8c-85df-ada9998d95c9
INFO:app.main:[CREDITS] Processing request for user: 47932d17-d8e7-4b8c-85df-ada9998d95c9 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.47932d17-d8e7-4b8c-85df-ada9998d95c9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 47932d17-d8e7-4b8c-85df-ada9998d95c9
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.47932d17-d8e7-4b8c-85df-ada9998d95c9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 47932d17-d8e7-4b8c-85df-ada9998d95c9
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 17/100 (remaining: 83)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.629f292600a4505d1a434286735a1f544c128dae25cc252601fa7aa2ae992995 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.47932d17-d8e7-4b8c-85df-ada9998d95c9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.47932d17-d8e7-4b8c-85df-ada9998d95c9 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 47932d17-d8e7-4b8c-85df-ada9998d95c9, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.47932d17-d8e7-4b8c-85df-ada9998d95c9 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 47932d17-d8e7-4b8c-85df-ada9998d95c9 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 47932d17-d8e7-4b8c-85df-ada9998d95c9: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=664e58b4...
INFO:scoring_v1_stable:[USAGE] Call #2/100 (Total: 2)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 347
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 3,
    "subject_prominence": 3,
    "emotion": 2,
    "text_readability": 0,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 4/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 2, 'text_readability': 0, 'color_contrast': 3, 'title_alignment': 0, 'niche_relevance': 4, 'notes': 'The image shows people working at computers, which is relevant to business content. However, there is no text, affecting readability and title alignment.'} -> rubric_score=39.6
I0000 00:00:1760589184.728018 13107891 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589184.731887 13108900 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=77 contrast=33 subject=12 sat=34 -> core=42
INFO:scoring_v1_stable:[Blend] final=40.3 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 40.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 40.3/100
[Inference] Processing 1 thumbnails for: 'How to Make $10K Per Month Online' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 5770ms. Winner: thumb1
INFO:     127.0.0.1:50664 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/main.py', 'scoring_v1_stable.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72087]
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72281]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72281]
[V1 ModelPipeline] Simplified mode - minimal model loading

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72348]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72348]
[V1 ModelPipeline] Simplified mode - minimal model loading
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72383]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 2f87aad4-4acb-47aa-b2b2-23f011879123
INFO:app.main:[CREDITS] Processing request for user: 2f87aad4-4acb-47aa-b2b2-23f011879123 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.2f87aad4-4acb-47aa-b2b2-23f011879123 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 2f87aad4-4acb-47aa-b2b2-23f011879123
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.2f87aad4-4acb-47aa-b2b2-23f011879123 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 2f87aad4-4acb-47aa-b2b2-23f011879123
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 18/100 (remaining: 82)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.2f87aad4-4acb-47aa-b2b2-23f011879123 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.2f87aad4-4acb-47aa-b2b2-23f011879123 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 2f87aad4-4acb-47aa-b2b2-23f011879123, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.2f87aad4-4acb-47aa-b2b2-23f011879123 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 2f87aad4-4acb-47aa-b2b2-23f011879123 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 2f87aad4-4acb-47aa-b2b2-23f011879123: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=c9b9eb9d...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 435
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and aligns well with the business niche. Color contrast is good, enhancing readability. Emotion is average, as the focus is more on information delivery.'} -> rubric_score=84.8
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760589344.059895 13111425 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760589344.107190 13112034 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=9 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=54.6 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] miss for hash=429ad5ee...
INFO:scoring_v1_stable:[USAGE] Call #2/100 (Total: 2)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 422
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': "The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to the business niche. Color contrast is good, enhancing readability. Emotion is average, as it doesn't convey strong feelings."} -> rubric_score=84.8
I0000 00:00:1760589350.706990 13111425 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589350.712762 13112213 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=7 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=54.6 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 54.6/100
INFO:scoring_v1_stable:[Cache] miss for hash=d9022e81...
INFO:scoring_v1_stable:[USAGE] Call #3/100 (Total: 3)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 422
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 4,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 4, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': "The thumbnail is visually appealing with clear text and good color contrast. The subject is prominent, and the content aligns well with the business niche. Emotion is average, as it doesn't strongly convey excitement or urgency."} -> rubric_score=80.6
I0000 00:00:1760589358.408389 13111425 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589358.413440 13112452 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=10 sat=15 -> core=41
INFO:scoring_v1_stable:[Blend] final=52.8 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 52.8/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 54.6/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 30770ms. Winner: thumb1
INFO:     127.0.0.1:51316 - "POST /v1/score HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72383]
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72526]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 1964c46c-d6e1-4033-a4dc-99e9b50f671f
INFO:app.main:[CREDITS] Processing request for user: 1964c46c-d6e1-4033-a4dc-99e9b50f671f (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.1964c46c-d6e1-4033-a4dc-99e9b50f671f "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 1964c46c-d6e1-4033-a4dc-99e9b50f671f
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.1964c46c-d6e1-4033-a4dc-99e9b50f671f "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 1964c46c-d6e1-4033-a4dc-99e9b50f671f
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 19/100 (remaining: 81)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.629f292600a4505d1a434286735a1f544c128dae25cc252601fa7aa2ae992995 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.1964c46c-d6e1-4033-a4dc-99e9b50f671f "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.1964c46c-d6e1-4033-a4dc-99e9b50f671f "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 1964c46c-d6e1-4033-a4dc-99e9b50f671f, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.1964c46c-d6e1-4033-a4dc-99e9b50f671f "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 1964c46c-d6e1-4033-a4dc-99e9b50f671f consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 1964c46c-d6e1-4033-a4dc-99e9b50f671f: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=664e58b4...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 387
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 3,
    "subject_prominence": 3,
    "emotion": 2,
    "text_readability": 0,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 4/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 2, 'text_readability': 0, 'color_contrast': 3, 'title_alignment': 2, 'niche_relevance': 4, 'notes': 'The thumbnail shows people working at computers, which is relevant to online business. However, it lacks text and emotional impact, and the connection to making money online is not very strong.'} -> rubric_score=43.1
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760589394.320916 13112865 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760589394.347452 13113329 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=77 contrast=33 subject=12 sat=34 -> core=42
INFO:scoring_v1_stable:[Blend] final=41.3 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 41.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 41.3/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 1 thumbnails for: 'How to Make $10K Per Month Online' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 12442ms. Winner: thumb1
INFO:     127.0.0.1:51530 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 0cec5b37-972c-47e5-8717-88ed3ef1e119
INFO:app.main:[CREDITS] Processing request for user: 0cec5b37-972c-47e5-8717-88ed3ef1e119 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.0cec5b37-972c-47e5-8717-88ed3ef1e119 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 0cec5b37-972c-47e5-8717-88ed3ef1e119
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.0cec5b37-972c-47e5-8717-88ed3ef1e119 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 0cec5b37-972c-47e5-8717-88ed3ef1e119
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 20/100 (remaining: 80)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.0cec5b37-972c-47e5-8717-88ed3ef1e119 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.0cec5b37-972c-47e5-8717-88ed3ef1e119 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 0cec5b37-972c-47e5-8717-88ed3ef1e119, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.0cec5b37-972c-47e5-8717-88ed3ef1e119 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 0cec5b37-972c-47e5-8717-88ed3ef1e119 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 0cec5b37-972c-47e5-8717-88ed3ef1e119: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=c9b9eb9d...
INFO:scoring_v1_stable:[USAGE] Call #2/100 (Total: 2)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 404
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content. The color contrast is good, and the thumbnail aligns well with a business-related title.'} -> rubric_score=84.8
I0000 00:00:1760589402.907423 13112865 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589402.912745 13113482 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=9 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=54.6 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] miss for hash=429ad5ee...
INFO:scoring_v1_stable:[USAGE] Call #3/100 (Total: 3)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 411
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content, aligning well with a business-related title. The color contrast is good, enhancing readability.'} -> rubric_score=84.8
I0000 00:00:1760589409.940482 13112865 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589409.943820 13113633 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=7 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=54.6 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 54.6/100
INFO:scoring_v1_stable:[Cache] miss for hash=d9022e81...
INFO:scoring_v1_stable:[USAGE] Call #4/100 (Total: 4)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 431
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content, aligning well with a potential business-related title. The color contrast is good, enhancing readability and focus.'} -> rubric_score=84.8
I0000 00:00:1760589417.253323 13112865 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589417.258456 13113713 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=10 sat=15 -> core=41
INFO:scoring_v1_stable:[Blend] final=55.1 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 55.1/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb3 with 55.1/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 22897ms. Winner: thumb3
INFO:     127.0.0.1:51537 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 041977de-4b36-4108-95f4-1ce1054717db
INFO:app.main:[CREDITS] Processing request for user: 041977de-4b36-4108-95f4-1ce1054717db (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.041977de-4b36-4108-95f4-1ce1054717db "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 041977de-4b36-4108-95f4-1ce1054717db
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.041977de-4b36-4108-95f4-1ce1054717db "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 041977de-4b36-4108-95f4-1ce1054717db
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 21/100 (remaining: 79)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.629f292600a4505d1a434286735a1f544c128dae25cc252601fa7aa2ae992995 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.041977de-4b36-4108-95f4-1ce1054717db "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.041977de-4b36-4108-95f4-1ce1054717db "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 041977de-4b36-4108-95f4-1ce1054717db, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.041977de-4b36-4108-95f4-1ce1054717db "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 041977de-4b36-4108-95f4-1ce1054717db consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 041977de-4b36-4108-95f4-1ce1054717db: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=664e58b4...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 41.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 41.3/100
[Inference] Processing 1 thumbnails for: 'How to Make $10K Per Month Online' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1350ms. Winner: thumb1
INFO:     127.0.0.1:51697 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 53c75f74-627e-4c67-9e42-8e5911b5ce97
INFO:app.main:[CREDITS] Processing request for user: 53c75f74-627e-4c67-9e42-8e5911b5ce97 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.53c75f74-627e-4c67-9e42-8e5911b5ce97 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 53c75f74-627e-4c67-9e42-8e5911b5ce97
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.53c75f74-627e-4c67-9e42-8e5911b5ce97 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 53c75f74-627e-4c67-9e42-8e5911b5ce97
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 22/100 (remaining: 78)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.629f292600a4505d1a434286735a1f544c128dae25cc252601fa7aa2ae992995 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.53c75f74-627e-4c67-9e42-8e5911b5ce97 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.53c75f74-627e-4c67-9e42-8e5911b5ce97 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 53c75f74-627e-4c67-9e42-8e5911b5ce97, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.53c75f74-627e-4c67-9e42-8e5911b5ce97 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 53c75f74-627e-4c67-9e42-8e5911b5ce97 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 53c75f74-627e-4c67-9e42-8e5911b5ce97: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=664e58b4...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 41.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 41.3/100
[Inference] Processing 1 thumbnails for: 'How to Make $10K Per Month Online' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1239ms. Winner: thumb1
INFO:     127.0.0.1:51870 - "POST /v1/score HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72526]

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72729]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'scoring_v1_stable.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:app.main:[Thumbscore.io] Shutting down AI thumbnail scoring service...
ERROR:    Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 738, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 613, in __aexit__
    await self._router.shutdown()
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 725, in shutdown
    await handler()
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 1597, in shutdown_event
    scheduler.shutdown()
  File "/usr/local/lib/python3.11/site-packages/apscheduler/schedulers/asyncio.py", line 13, in wrapper
    self._eventloop.call_soon_threadsafe(wrapped)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'

ERROR:    Application shutdown failed. Exiting.
INFO:     Finished server process [72729]
[V1 ModelPipeline] Simplified mode - minimal model loading

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 78, in subprocess_started
    target(sockets=sockets)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
  File "/usr/local/lib/python3.11/site-packages/uvicorn/config.py", line 458, in load
    self.loaded_app = import_from_string(self.app)
  File "/usr/local/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/local/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/nicvenettacci/Desktop/Thumbnail Lab/thumbnail-lab/python-service/app/main.py", line 19, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1477, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 9, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
INFO:app.main:[V1] Skipping FAISS and complex ML imports
INFO:app.main:[V1] Using simplified scoring system (FAISS disabled)
INFO:app.main:[V1] Simplified scoring mode - deterministic caching disabled
INFO:app.main:[V1] Score version: v1.0-simple
INFO:app.main:[V1] Model version: simplified-v1.0
INFO:     Started server process [72743]
INFO:     Waiting for application startup.
INFO:app.main:[Thumbscore.io] Starting up AI thumbnail scoring service...
INFO:app.main:[V1] ✅ Simplified scoring system enabled (FAISS disabled)
INFO:app.main:[V1] Using stable GPT-4 Vision + numeric core for deterministic scoring
INFO:app.main:[V1] Skipping FAISS and complex model initialization
INFO:app.main:[V1] FAISS loading skipped - using simplified scoring
INFO:app.main:[V1] Scheduler disabled - no FAISS index rebuilding needed
INFO:app.main:[Thumbscore.io] ✅ Startup complete - using simplified (V1)
INFO:     Application startup complete.
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rpc/reset_credits_monthly "HTTP/1.1 204 No Content"
INFO:app.credits:[CREDITS] Monthly credit reset completed
ERROR:app.cache_kv:[CACHE] Error cleaning up expired cache: SyncClient.rpc() missing 1 required positional argument: 'params'
ERROR:app.rate_limiting:[RATE_LIMIT] Error cleaning up rate limits: SyncClient.rpc() missing 1 required positional argument: 'params'
INFO:app.credits:[CREDITS] New anonymous user: 22f03309-3ce7-4478-b537-0c42f05d8849
INFO:app.main:[CREDITS] Processing request for user: 22f03309-3ce7-4478-b537-0c42f05d8849 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.22f03309-3ce7-4478-b537-0c42f05d8849 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 22f03309-3ce7-4478-b537-0c42f05d8849
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.22f03309-3ce7-4478-b537-0c42f05d8849 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 22f03309-3ce7-4478-b537-0c42f05d8849
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 23/100 (remaining: 77)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.22f03309-3ce7-4478-b537-0c42f05d8849 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.22f03309-3ce7-4478-b537-0c42f05d8849 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 22f03309-3ce7-4478-b537-0c42f05d8849, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.22f03309-3ce7-4478-b537-0c42f05d8849 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 22f03309-3ce7-4478-b537-0c42f05d8849 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 22f03309-3ce7-4478-b537-0c42f05d8849: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=c9b9eb9d...
INFO:scoring_v1_stable:[USAGE] Call #1/100 (Total: 1)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 493
INFO:scoring_v1_stable:[GPT-4] Raw response preview: ```json
{
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readabili...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content, aligning well with a potential business-related title. The color contrast is good, enhancing readability. Emotion is moderate, focusing more on information delivery.'} -> rubric_score=84.8
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760589543.354783 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1760589543.371916 13116194 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=9 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=54.6 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] miss for hash=429ad5ee...
INFO:scoring_v1_stable:[USAGE] Call #2/100 (Total: 2)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 427
INFO:scoring_v1_stable:[GPT-4] Raw response preview: ```json
{
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readabili...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 3, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content, indicating a good niche match. The emotion is neutral, and the alignment with the title is average.'} -> rubric_score=81.6
I0000 00:00:1760589550.186384 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589550.188214 13116284 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=7 sat=15 -> core=40
INFO:scoring_v1_stable:[Blend] final=52.9 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 52.9/100
INFO:scoring_v1_stable:[Cache] miss for hash=d9022e81...
INFO:scoring_v1_stable:[USAGE] Call #3/100 (Total: 3)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 415
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readability": 4,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 4, 'color_contrast': 4, 'title_alignment': 3, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear subject prominence. The text is readable and relevant to business content, matching the niche well. The emotion is neutral, and the alignment with a generic title is average.'} -> rubric_score=81.6
I0000 00:00:1760589561.193080 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589561.195084 13116473 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=22 subject=10 sat=15 -> core=41
INFO:scoring_v1_stable:[Blend] final=53.3 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 53.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 54.6/100
[V1 ModelPipeline] Simplified mode - minimal model loading
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 29544ms. Winner: thumb1
INFO:     127.0.0.1:52280 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05
INFO:app.main:[CREDITS] Processing request for user: 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 24/100 (remaining: 76)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 9d4023d7-6aa5-4c21-a7b7-de6e04cdce05: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=c9b9eb9d...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] hit for hash=429ad5ee...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 52.9/100
INFO:scoring_v1_stable:[Cache] hit for hash=d9022e81...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 53.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 54.6/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1619ms. Winner: thumb1
INFO:     127.0.0.1:52282 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e
INFO:app.main:[CREDITS] Processing request for user: 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.3a9a4e31-4c4c-4b23-ac19-e5d21907f26e "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.3a9a4e31-4c4c-4b23-ac19-e5d21907f26e "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 25/100 (remaining: 75)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.0fbe9dad2094ca0e9575e25bc375a82d9626e8b61ca5f86405769873954c2fe0 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.af197cb2f020a375fd257b5742689e3670e54ff4985cf45bb280221ade9036fa "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a1b4ddb604a9cd18700d17f0a3282dabdd5385b2ef9f73b9acc010ba6a81629e "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.3a9a4e31-4c4c-4b23-ac19-e5d21907f26e "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.3a9a4e31-4c4c-4b23-ac19-e5d21907f26e "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.3a9a4e31-4c4c-4b23-ac19-e5d21907f26e "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 3a9a4e31-4c4c-4b23-ac19-e5d21907f26e: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=12c6d7a0...
INFO:scoring_v1_stable:[USAGE] Call #4/100 (Total: 4)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 386
INFO:scoring_v1_stable:[GPT-4] Raw response preview: ```json
{
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 3,
    "text_readabili...
WARNING:scoring_v1_stable:[NICHE] Heavy penalty applied: 1/5 -> 86.2 -> 17.2 (80% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 3, 'text_readability': 5, 'color_contrast': 5, 'title_alignment': 2, 'niche_relevance': 1, 'notes': 'The thumbnail is visually appealing with clear text and strong color contrast. The subjects are prominent, but the content is more aligned with health/fitness rather than business.'} -> rubric_score=17.2
I0000 00:00:1760589616.339400 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589616.341155 13117292 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=84 contrast=53 subject=36 sat=31 -> core=54
INFO:scoring_v1_stable:[Blend] final=36.9 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 36.9/100
INFO:scoring_v1_stable:[Cache] miss for hash=a560606f...
INFO:scoring_v1_stable:[USAGE] Call #5/100 (Total: 5)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 474
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 4,
    "text_readability": 5,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 5/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 4, 'text_readability': 5, 'color_contrast': 4, 'title_alignment': 4, 'niche_relevance': 5, 'notes': 'The thumbnail is visually appealing with clear text and good color contrast. The subject is prominent and conveys a strong emotion of surprise or excitement. The text aligns well with a business or finance niche, suggesting high earnings potential, which is relevant to the niche.'} -> rubric_score=93.3
I0000 00:00:1760589624.388018 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589624.390978 13117399 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=70 contrast=35 subject=7 sat=29 -> core=39
INFO:scoring_v1_stable:[Blend] final=58.9 confidence=low
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 58.9/100
INFO:scoring_v1_stable:[Cache] miss for hash=90cc6eb2...
INFO:scoring_v1_stable:[USAGE] Call #6/100 (Total: 6)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 435
INFO:scoring_v1_stable:[GPT-4] Raw response preview: ```json
{
    "visual_appeal": 4,
    "subject_prominence": 5,
    "emotion": 4,
    "text_readabili...
INFO:scoring_v1_stable:[NICHE] Slight penalty applied: 3/5 -> 89.8 -> 71.8 (20% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 4, 'subject_prominence': 5, 'emotion': 4, 'text_readability': 5, 'color_contrast': 4, 'title_alignment': 3, 'niche_relevance': 3, 'notes': "The thumbnail is visually appealing with clear text and strong subject prominence. The emotion conveyed is curiosity or secrecy. The niche relevance and title alignment are average, as the content's business relevance is unclear."} -> rubric_score=71.8
I0000 00:00:1760589631.889292 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589631.891213 13117507 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=97 contrast=69 subject=36 sat=73 -> core=72
INFO:scoring_v1_stable:[Blend] final=61.9 confidence=high
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 61.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb3 with 61.9/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 24692ms. Winner: thumb3
INFO:     127.0.0.1:52600 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 4a431fcf-26c7-4a74-9c1e-254a6bfeda31
INFO:app.main:[CREDITS] Processing request for user: 4a431fcf-26c7-4a74-9c1e-254a6bfeda31 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.4a431fcf-26c7-4a74-9c1e-254a6bfeda31 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 4a431fcf-26c7-4a74-9c1e-254a6bfeda31
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.4a431fcf-26c7-4a74-9c1e-254a6bfeda31 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 4a431fcf-26c7-4a74-9c1e-254a6bfeda31
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 26/100 (remaining: 74)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.0fbe9dad2094ca0e9575e25bc375a82d9626e8b61ca5f86405769873954c2fe0 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.af197cb2f020a375fd257b5742689e3670e54ff4985cf45bb280221ade9036fa "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a1b4ddb604a9cd18700d17f0a3282dabdd5385b2ef9f73b9acc010ba6a81629e "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.4a431fcf-26c7-4a74-9c1e-254a6bfeda31 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.4a431fcf-26c7-4a74-9c1e-254a6bfeda31 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 4a431fcf-26c7-4a74-9c1e-254a6bfeda31, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.4a431fcf-26c7-4a74-9c1e-254a6bfeda31 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 4a431fcf-26c7-4a74-9c1e-254a6bfeda31 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 4a431fcf-26c7-4a74-9c1e-254a6bfeda31: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=12c6d7a0...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 36.9/100
INFO:scoring_v1_stable:[Cache] hit for hash=a560606f...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 58.9/100
INFO:scoring_v1_stable:[Cache] hit for hash=90cc6eb2...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 61.9/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb3 with 61.9/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1356ms. Winner: thumb3
INFO:     127.0.0.1:52603 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: a83a2023-e3f2-4619-8b2d-b2eeb9811f43
INFO:app.main:[CREDITS] Processing request for user: a83a2023-e3f2-4619-8b2d-b2eeb9811f43 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.a83a2023-e3f2-4619-8b2d-b2eeb9811f43 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: a83a2023-e3f2-4619-8b2d-b2eeb9811f43
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.a83a2023-e3f2-4619-8b2d-b2eeb9811f43 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: a83a2023-e3f2-4619-8b2d-b2eeb9811f43
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 27/100 (remaining: 73)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.a6796c44031166107af9314b97e24cea3aa6828748390c50e9e213599d6e3b35 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.a83a2023-e3f2-4619-8b2d-b2eeb9811f43 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.a83a2023-e3f2-4619-8b2d-b2eeb9811f43 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: a83a2023-e3f2-4619-8b2d-b2eeb9811f43, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.a83a2023-e3f2-4619-8b2d-b2eeb9811f43 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User a83a2023-e3f2-4619-8b2d-b2eeb9811f43 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user a83a2023-e3f2-4619-8b2d-b2eeb9811f43: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=640d66fb...
INFO:scoring_v1_stable:[USAGE] Call #7/100 (Total: 7)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 460
INFO:scoring_v1_stable:[GPT-4] Raw response preview: I'm unable to analyze or provide ratings for this image as it doesn't contain any business-related e...
ERROR:scoring_v1_stable:[GPT-4] JSON parse error: Expecting value: line 1 column 1 (char 0)
ERROR:scoring_v1_stable:[GPT-4] Content that failed to parse: I'm unable to analyze or provide ratings for this image as it doesn't contain any business-related elements or text that can be evaluated for a YouTube thumbnail in the business niche. 

```json
{
    "visual_appeal": 0,
    "subject_prominence": 0,
    "emotion": 0,
    "text_readability": 0,
    "color_contrast": 0,
    "title_alignment": 0,
    "niche_relevance": 0,
    "notes": "The image is a portrait and lacks business-related content or text."
}
```
ERROR:scoring_v1_stable:GPT-4 Vision rubric failed: Invalid JSON response: Expecting value: line 1 column 1 (char 0)
INFO:scoring_v1_stable:[NICHE] Slight penalty applied: 3/5 -> 58.8 -> 47.0 (20% reduction)
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 3, 'text_readability': 3, 'color_contrast': 3, 'title_alignment': 2, 'niche_relevance': 3, 'notes': 'Fallback scoring due to API error'} -> rubric_score=47.0
I0000 00:00:1760589743.477380 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589743.487156 13119545 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=91 contrast=23 subject=66 sat=40 -> core=55
INFO:scoring_v1_stable:[Blend] final=45.3 confidence=high
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 45.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 45.3/100
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 7236ms. Winner: thumb1
INFO:     127.0.0.1:53164 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa
INFO:app.main:[CREDITS] Processing request for user: 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 28/100 (remaining: 72)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.2f2d456323b41616ef4bf8d4b13b65c61028c352d689383ac4c9995d32a104cb "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 64d6ba8b-00ce-4ba0-ba42-c8b5f16ab7fa: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 1 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 1 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] miss for hash=664e58b4...
INFO:scoring_v1_stable:[USAGE] Call #8/100 (Total: 8)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:scoring_v1_stable:[GPT-4] Raw response length: 342
INFO:scoring_v1_stable:[GPT-4] Raw response preview: {
    "visual_appeal": 3,
    "subject_prominence": 3,
    "emotion": 2,
    "text_readability": 0,
...
INFO:scoring_v1_stable:[NICHE] Good niche match: 4/5 -> No penalty applied
INFO:scoring_v1_stable:[Rubric] scores: {'visual_appeal': 3, 'subject_prominence': 3, 'emotion': 2, 'text_readability': 0, 'color_contrast': 3, 'title_alignment': 2, 'niche_relevance': 4, 'notes': 'The thumbnail shows people working at computers, which is relevant to business content. However, it lacks text for clarity and emotional engagement.'} -> rubric_score=43.1
I0000 00:00:1760589761.591367 13115254 gl_context.cc:357] GL version: 2.1 (2.1 ATI-5.5.17), renderer: AMD Radeon Pro 5300M OpenGL Engine
W0000 00:00:1760589761.595630 13119862 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
/usr/local/lib/python3.11/site-packages/google/protobuf/symbol_database.py:55: UserWarning: SymbolDatabase.GetPrototype() is deprecated. Please use message_factory.GetMessageClass() instead. SymbolDatabase.GetPrototype() will be removed soon.
  warnings.warn('SymbolDatabase.GetPrototype() is deprecated. Please '
INFO:scoring_v1_stable:[Core] text=77 contrast=33 subject=12 sat=34 -> core=42
INFO:scoring_v1_stable:[Blend] final=41.3 confidence=medium
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 41.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 41.3/100
[Inference] Processing 1 thumbnails for: 'Test Video' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 6463ms. Winner: thumb1
INFO:     127.0.0.1:53264 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 03136955-f96a-405b-9e68-0a780651d3a2
INFO:app.main:[CREDITS] Processing request for user: 03136955-f96a-405b-9e68-0a780651d3a2 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.03136955-f96a-405b-9e68-0a780651d3a2 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 03136955-f96a-405b-9e68-0a780651d3a2
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.03136955-f96a-405b-9e68-0a780651d3a2 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 03136955-f96a-405b-9e68-0a780651d3a2
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 29/100 (remaining: 71)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.03136955-f96a-405b-9e68-0a780651d3a2 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.03136955-f96a-405b-9e68-0a780651d3a2 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 03136955-f96a-405b-9e68-0a780651d3a2, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.03136955-f96a-405b-9e68-0a780651d3a2 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 03136955-f96a-405b-9e68-0a780651d3a2 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 03136955-f96a-405b-9e68-0a780651d3a2: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=c9b9eb9d...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] hit for hash=429ad5ee...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 52.9/100
INFO:scoring_v1_stable:[Cache] hit for hash=d9022e81...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 53.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 54.6/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 2149ms. Winner: thumb1
INFO:     127.0.0.1:55530 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: 9ad8d394-88d4-456a-a6b6-b6154d8d9048
INFO:app.main:[CREDITS] Processing request for user: 9ad8d394-88d4-456a-a6b6-b6154d8d9048 (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.9ad8d394-88d4-456a-a6b6-b6154d8d9048 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: 9ad8d394-88d4-456a-a6b6-b6154d8d9048
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.9ad8d394-88d4-456a-a6b6-b6154d8d9048 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: 9ad8d394-88d4-456a-a6b6-b6154d8d9048
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 30/100 (remaining: 70)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.aae1e3c36413a24faa66bef4c8d99ea0fd29deb9da30d8c7fcbcf26dfc16ac74 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.1715c308ab0c62515e276511f4281e61e98c3b68a2f8fb1bd42517e2b11731c7 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/score_cache?select=payload&cache_key=eq.8bdcf02a0fbe17973d2be4e8b75ea0ca7bb5723626c9e6ab5c73a3c4755819e9 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.9ad8d394-88d4-456a-a6b6-b6154d8d9048 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.9ad8d394-88d4-456a-a6b6-b6154d8d9048 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] Found existing wallet for user: 9ad8d394-88d4-456a-a6b6-b6154d8d9048, plan: free
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?user_id=eq.9ad8d394-88d4-456a-a6b6-b6154d8d9048 "HTTP/1.1 200 OK"
INFO:app.credits:[CREDITS] User 9ad8d394-88d4-456a-a6b6-b6154d8d9048 consumed credit: 1/50 (remaining: 49)
INFO:app.main:[CREDITS] Consumed credit for user 9ad8d394-88d4-456a-a6b6-b6154d8d9048: 1/50 (remaining: 49)
INFO:app.main:[PROCESSING] Processing 3 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 3 thumbnails for business niche
INFO:scoring_v1_stable:[Cache] hit for hash=c9b9eb9d...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb1: 54.6/100
INFO:scoring_v1_stable:[Cache] hit for hash=429ad5ee...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb2: 52.9/100
INFO:scoring_v1_stable:[Cache] hit for hash=d9022e81...
INFO:scoring_v1_stable:[STABLE_SCORER] thumb3: 53.3/100
INFO:scoring_v1_stable:[STABLE_SCORER] Winner: thumb1 with 54.6/100
[Inference] Processing 3 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 1002ms. Winner: thumb1
INFO:     127.0.0.1:55531 - "POST /v1/score HTTP/1.1" 200 OK
INFO:app.credits:[CREDITS] New anonymous user: b4f3d368-cc2b-4075-b912-cb1d4505488d
INFO:app.main:[CREDITS] Processing request for user: b4f3d368-cc2b-4075-b912-cb1d4505488d (type: anonymous)
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users?select=id&id=eq.b4f3d368-cc2b-4075-b912-cb1d4505488d "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/users "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created user record: b4f3d368-cc2b-4075-b912-cb1d4505488d
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits?select=%2A&user_id=eq.b4f3d368-cc2b-4075-b912-cb1d4505488d "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/credits "HTTP/1.1 201 Created"
INFO:app.credits:[CREDITS] Created credits wallet for user: b4f3d368-cc2b-4075-b912-cb1d4505488d
INFO:httpx:HTTP Request: GET https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?select=hits&ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: PATCH https://eubfjhegyvivesqgpvlh.supabase.co/rest/v1/rate_limits?ip=eq.127.0.0.1&window_start=eq.2025-10-16T15%3A00%3A00 "HTTP/1.1 200 OK"
INFO:app.rate_limiting:[RATE_LIMIT] Request allowed for IP 127.0.0.1: 31/100 (remaining: 69)
INFO:app.main:[PROCESSING] Processing 0 non-cached thumbnails
INFO:scoring_v1_stable:[STABLE_SCORER] Analyzing 0 thumbnails for business niche
[Inference] Processing 0 thumbnails for: 'Sample Video Title' (niche: business)
[V1] Using stable V1 scoring system for niche 'business'
[V1] Completed in 979ms. Winner: none
INFO:     127.0.0.1:57536 - "POST /v1/score HTTP/1.1" 200 OK
